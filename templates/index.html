<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ÙƒØ´Ù Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ù…Ø²ÙŠÙØ© - AI</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Cairo", sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }

      .navbar-brand {
        font-weight: bold;
        font-size: 1.5rem;
      }

      .card {
        border-radius: 15px;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        border: none;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        padding: 12px 30px;
        font-weight: bold;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .result-box {
        transition: all 0.3s ease;
        border-radius: 10px;
        padding: 20px;
        margin-top: 20px;
      }

      .result-danger {
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
        color: white;
      }

      .result-warning {
        background: linear-gradient(135deg, #ffd93d 0%, #ff9a3d 100%);
        color: #333;
      }

      .result-success {
        background: linear-gradient(135deg, #6bcf7f 0%, #4caf50 100%);
        color: white;
      }

      .reason-item {
        background: rgba(255, 255, 255, 0.1);
        padding: 8px 15px;
        border-radius: 20px;
        margin: 5px;
        display: inline-block;
      }

      .loading {
        display: none;
      }

      .google-result {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 10px;
        padding: 15px;
        margin-top: 10px;
        border-right: 4px solid #4285f4;
      }
    </style>
  </head>
  <body>
    <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ -->
    <nav
      class="navbar navbar-expand-lg navbar-dark"
      style="background: rgba(0, 0, 0, 0.2)"
    >
      <div class="container">
        <a class="navbar-brand" href="/home"> ğŸ” ÙƒØ´Ù Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ù…Ø²ÙŠÙØ© - AI </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="/home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/history">Ø§Ù„Ø³Ø¬Ù„</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/logout">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a>
            </li>
          </ul>
          <span class="navbar-text me-3"> Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ {{ name }} </span>
        </div>
      </div>
    </nav>

    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-lg-10">
          <div class="card shadow-lg">
            <div class="card-header bg-white text-center py-4">
              <h2 class="mb-0">
                ğŸ” Ù†Ø¸Ø§Ù… ÙƒØ´Ù Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ù…Ø²ÙŠÙØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
              </h2>
              <p class="text-muted mt-2">Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø¨Ø± Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­ØªÙ‡</p>
            </div>

            <div class="card-body p-5">
              <form id="detectionForm">
                <div class="mb-4">
                  <label class="form-label fw-bold">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø¨Ø±</label>
                  <input
                    type="text"
                    class="form-control form-control-lg"
                    id="title"
                    name="title"
                    placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø¨Ø± Ù‡Ù†Ø§..."
                    required
                  />
                </div>

                <div class="mb-4">
                  <label class="form-label fw-bold">Ù†Øµ Ø§Ù„Ø®Ø¨Ø±</label>
                  <textarea
                    class="form-control"
                    id="text"
                    name="text"
                    rows="6"
                    placeholder="Ø£Ø¯Ø®Ù„ Ù†Øµ Ø§Ù„Ø®Ø¨Ø± Ø§Ù„ÙƒØ§Ù…Ù„ Ù‡Ù†Ø§..."
                  ></textarea>
                </div>

                <div class="mb-4">
                  <label class="form-label fw-bold">Ù…ØµØ¯Ø± Ø§Ù„Ø®Ø¨Ø± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                  <input
                    type="text"
                    class="form-control"
                    id="source"
                    name="source"
                    placeholder="Ù…Ø«Ø§Ù„: www.bbc.com"
                  />
                </div>

                <div class="text-center">
                  <button type="submit" class="btn btn-primary btn-lg">
                    <span id="submitText">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø®Ø¨Ø±</span>
                    <div
                      class="spinner-border spinner-border-sm text-white loading"
                      id="loadingSpinner"
                      role="status"
                    ></div>
                  </button>
                </div>
              </form>

              <!-- Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„ -->
              <div id="resultContainer" class="mt-5" style="display: none">
                <h3 class="mb-4">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„</h3>

                <!-- Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
                <div id="mainResult" class="result-box text-center">
                  <h2 id="resultTitle" class="mb-3"></h2>
                  <div class="row justify-content-center">
                    <div class="col-md-8">
                      <div class="card">
                        <div class="card-body">
                          <h5 id="resultScore" class="card-title"></h5>
                          <p id="resultConfidence" class="card-text"></p>
                          <div id="resultReasons"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Ù†ØªØ§Ø¦Ø¬ Google Fact Check -->
                <div id="googleResults" class="mt-4" style="display: none">
                  <h4>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Google Fact Check</h4>
                  <div id="googleResultsContent"></div>
                </div>

                <!-- Ù†ØµÙŠØ­Ø© -->
                <div class="alert alert-info mt-4">
                  <h5>ğŸ’¡ Ù†ØµÙŠØ­Ø©</h5>
                  <p id="adviceText" class="mb-0"></p>
                </div>
              </div>
            </div>

            <div class="card-footer text-center text-muted py-3">
              <small
                >Ù†Ø¸Ø§Ù… ÙƒØ´Ù Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ù…Ø²ÙŠÙØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ | ÙØ±ÙŠÙ‚
                Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Â© 2025</small
              >
            </div>
          </div>

          <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… -->
          <div class="row mt-4">
            <div class="col-md-4">
              <div class="card text-center h-100">
                <div class="card-body">
                  <h3>ğŸ“Š Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯</h3>
                  <p class="text-muted">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Øµ Ø¨Ø£ÙƒØ«Ø± Ù…Ù† 50 Ù‚Ø§Ø¹Ø¯Ø© Ù„Ù„ÙƒØ´Ù</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="card text-center h-100">
                <div class="card-body">
                  <h3>ğŸ”— Google API</h3>
                  <p class="text-muted">Ø§Ù„ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ù‚Ø§Ø¦Ù‚</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="card text-center h-100">
                <div class="card-body">
                  <h3>ğŸ“ˆ ØªØ­Ù„ÙŠÙ„ Ø°ÙƒÙŠ</h3>
                  <p class="text-muted">Ù†Ø¸Ø§Ù… Ù‡Ø¬ÙŠÙ† (AI Ø¨Ø¯ÙˆÙ† ØªØ¹Ù„Ù… Ø¢Ù„ÙŠ)</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document
        .getElementById("detectionForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
          document.getElementById("loadingSpinner").style.display =
            "inline-block";
          document.getElementById("submitText").textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...";

          // Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
          const formData = new FormData(this);

          try {
            const response = await fetch("/detect", {
              method: "POST",
              body: formData,
            });

            const data = await response.json();

            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„
            document.getElementById("loadingSpinner").style.display = "none";
            document.getElementById("submitText").textContent = "ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø®Ø¨Ø±";

            // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            displayResults(data);
          } catch (error) {
            console.error("Error:", error);
            alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„");
            document.getElementById("loadingSpinner").style.display = "none";
            document.getElementById("submitText").textContent = "ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø®Ø¨Ø±";
          }
        });

      function displayResults(data) {
        const resultContainer = document.getElementById("resultContainer");
        const mainResult = document.getElementById("mainResult");
        const resultTitle = document.getElementById("resultTitle");
        const resultScore = document.getElementById("resultScore");
        const resultConfidence = document.getElementById("resultConfidence");
        const resultReasons = document.getElementById("resultReasons");
        const googleResults = document.getElementById("googleResults");
        const googleResultsContent = document.getElementById(
          "googleResultsContent"
        );
        const adviceText = document.getElementById("adviceText");

        // Ø¥Ø¸Ù‡Ø§Ø± Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù†ØªØ§Ø¦Ø¬
        resultContainer.style.display = "block";

        // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„ÙˆÙ† Ø­Ø³Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø©
        mainResult.className = `result-box text-center result-${data.color}`;

        // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†ØµÙˆØµ
        resultTitle.textContent = data.result;
        resultScore.textContent = `Ø¯Ø±Ø¬Ø© Ø§Ù„Ø«Ù‚Ø©: ${data.score}%`;
        resultConfidence.textContent = `Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø©: ${data.confidence}`;

        // Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨
        resultReasons.innerHTML = '<h6 class="mt-3">Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ:</h6>';
        if (data.reasons && data.reasons.length > 0) {
          data.reasons.forEach((reason) => {
            const reasonItem = document.createElement("span");
            reasonItem.className = "reason-item";
            reasonItem.textContent = reason;
            resultReasons.appendChild(reasonItem);
          });
        }

        // Ø¹Ø±Ø¶ Ù†ØªØ§Ø¦Ø¬ Google Ø¥Ø°Ø§ ÙˆØ¬Ø¯Øª
        if (data.google_results && data.google_results.length > 0) {
          googleResults.style.display = "block";
          googleResultsContent.innerHTML = "";

          data.google_results.forEach((result, index) => {
            const googleCard = document.createElement("div");
            googleCard.className = "google-result mb-3";
            googleCard.innerHTML = `
                        <h6>${result.reviewer || "Ù…ØµØ¯Ø± ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"}</h6>
                        <p class="mb-1"><strong>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:</strong> ${
                          result.rating || "ØºÙŠØ± Ù…ØªÙˆÙØ±"
                        }</p>
                        <p class="mb-1"><strong>Ø§Ù„Ù…Ø¯Ø¹ÙŠ:</strong> ${
                          result.claimant || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"
                        }</p>
                        ${
                          result.url
                            ? `<a href="${result.url}" target="_blank" class="btn btn-sm btn-info mt-2">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</a>`
                            : ""
                        }
                    `;
            googleResultsContent.appendChild(googleCard);
          });
        } else {
          googleResults.style.display = "none";
        }

        // Ù†ØµÙŠØ­Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù†ØªÙŠØ¬Ø©
        if (data.result.includes("Ù…Ø²ÙŠÙ")) {
          adviceText.textContent =
            "âš ï¸ Ù‡Ø°Ø§ Ø§Ù„Ø®Ø¨Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±Ø¬Ø­ Ù…Ø²ÙŠÙ. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…ØµØ§Ø¯Ø± Ù…ÙˆØ«ÙˆÙ‚Ø© Ù‚Ø¨Ù„ Ù†Ø´Ø±Ù‡.";
        } else if (data.result.includes("Ù…Ø´Ø¨ÙˆÙ‡")) {
          adviceText.textContent =
            "ğŸ¤” Ù‡Ø°Ø§ Ø§Ù„Ø®Ø¨Ø± Ù…Ø´Ø¨ÙˆÙ‡. ÙŠÙØ¶Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù†Ù‡ Ù…Ù† Ù…ØµØ§Ø¯Ø± Ø£Ø®Ø±Ù‰ Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ù„ÙŠÙ‡.";
        } else {
          adviceText.textContent =
            "âœ… Ù‡Ø°Ø§ Ø§Ù„Ø®Ø¨Ø± ÙŠØ¨Ø¯Ùˆ Ø­Ù‚ÙŠÙ‚ÙŠØ§Ù‹. ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø´Ø§Ø±ÙƒØªÙ‡ Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ­Ø¯ÙŠØ«Ø§ØªÙ‡.";
        }

        // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„Ù„Ù†ØªØ§Ø¦Ø¬
        resultContainer.scrollIntoView({ behavior: "smooth" });
      }
    </script>
  </body>
</html>
